<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Line Graphs</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="1-learn.html">Viridis Colors</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Line Graphs</h1>

</div>


<p>LINE GRAPHS</p>
<p>Data representation is a critical part of being a scientist. So in this section of the course, we’re going to take some data - large and small scale - and determine which plot to use to visualise the data. And then make gorgeous plots! This is our example for today: you are a Biochemist, let’s say. You study a virus, HIV, and want to show the number of papers published on 7 HIV proteins over ~30 years, to see which targets are the least studied. Think about what kind of plot would best show this data.</p>
<p>So, we have 2 categorical variables. If you came up with a <b>line graph</b>, you’d be right! No need to get fancy - a lot of the time in data representation, the simplest answer is the best. After all, you want your reader to look at the graph and know what they’re looking at!</p>
<p>Today’s aim: Make a line graph</p>
<p>This data was obtained from PubMed using the ‘best search’ option and filtering out reviews. I specifically searched for HIV and the gene name. First, navigate to your working directory and import the dataset, which you can find at <a href="https://github.com/ctrumanshow/Learn_R_In_An_HouR" class="uri">https://github.com/ctrumanshow/Learn_R_In_An_HouR</a> under the name ‘Timeline2.csv.’</p>
<pre class="r"><code>library(tidyverse, warn.conflicts=FALSE) #We will be using the tidyverse!
library(ggplot2) #We will use ggplot2 for plotting!
require(gridExtra) #We use this later to show 2 plots side-by-side

setwd(&#39;C:/Users/Greye/Dropbox/DPHIL PHD UPDATED/PROGRAMMING + SCRIPTING/R IN A HR/ggridges&#39;) #Change this to indicate where your files are
Data &lt;- read_csv(&#39;Timeline2.csv&#39;) #Read in your file (read_csv is a wrapper function from readr in tidyverse, one reason we need it!)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Year = col_double(),
##   Publications = col_double(),
##   Gene = col_character()
## )</code></pre>
<pre class="r"><code>view(Data) #Let&#39;s look at the data. Try and describe what each of the columns mean </code></pre>
<p>
You’ll notice that read_csv gives you a message. This tells you that since you did not pass the function what
<div class="tooltip">
type<span class="tooltiptext">Recall our discussion of different types of data: characters, integers, numeric etc! Revisit chapter x if this doesn’t ring a bell.</span>
</div>
<p>of data each column is, it makes it’s own assumptions. <i>Side note:</i> if you know the data already, you can specify the type when you read in the data, avoiding corrections later on:</p>
<pre class="r"><code>Data &lt;- read_csv(&#39;Timeline2.csv&#39;, col_types = cols(
    Year = col_character(),
    Publications = col_integer(),
    Gene = col_character()
    ))
    
head(Data)</code></pre>
<pre><code>## # A tibble: 6 x 3
##   Year  Publications Gene 
##   &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;
## 1 2019            19 Rev  
## 2 2018            32 Rev  
## 3 2017            27 Rev  
## 4 2016            31 Rev  
## 5 2015            34 Rev  
## 6 2014            39 Rev</code></pre>
<p>Compare the types (<i>shown in italics under column names</i>) before and after!</p>
<p>But wait.. it’s 2019 (when I wrote this!) - so we can’t trust the number of publications, since more are likely to come out. Let’s remove these entries. To do this, we have to tell R 2 things:<br> 1) Find all rows with ‘2019’ in the year column<br> 2) Remove these rows We can do this in 1 step using dplyr, from tidyverse. Simply us the filter function to select your dataset (Data), and filter by any Year whose value does not equate (!=) to 2019, and re-assign this to the Data variable.</p>
<pre class="r"><code>Data &lt;- filter(Data, Year != &quot;2019&quot;)</code></pre>
<p>Now, let’s plot! We will use pipe function ‘%&gt;%’ - this simply tells R to pass what is before the pipe to the commands that come after. We call ggplot first, to show we are plotting. Aes, or aesthetic is used to define what values we will be plotting. On our X axis, we will have the independent variable: year. On our Y, we will have our dependent variable: number of publications. We will also plot these variables for 7 differet genes, and will call the info from each gene a <i>group</i>. So we call our groups by Gene. We’ve told ggplot what we want to plot, now let’s tellit what type of plotting to do - this is <i>geom_line</i>for a line graph. Let’s see how it looks!</p>
<pre class="r"><code>Plot_First &lt;- Data %&gt;% ggplot(aes(x = Year, y=Publications, group=Gene)) + geom_line()</code></pre>
<p>And we’ve made a graph! But if you showed this to a stranger, they wouldn’t know what they were looking at! First of all, let’s add a legend and colour the genes to show which is which.</p>
<pre class="r"><code>Data %&gt;% ggplot(aes(x = Year, y=Publications, group=Gene, color=Gene)) + geom_line()</code></pre>
<p><img src="learn_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>There! Looks a lot nicer. But whatsay we pick some nice custom colours and make it a little prettier! First, let’s pick 7 colours that are clearly distinguished and nice to look at, and put them together - replace my colours with ones you’ve picked yourself! You can use built-in colours, like ‘red’ or ‘blue.’ To really personalise, I recommend <a href="https://www.rapidtables.com/web/color/RGB_Color.html" class="uri">https://www.rapidtables.com/web/color/RGB_Color.html</a>. We can add scale_color_manual on the end to tell the functions that we want to use our collection of colours.</p>
<pre class="r"><code>Line_Colours &lt;- c(&#39;#FF6B6B&#39;,&quot;#FF6BE7&quot;, &quot;#C96BFF&quot;, &quot;#6B92FF&quot;, &quot;#6BFF9C&quot;, &quot;#FFC46B&quot;, &quot;#008E8040&quot;)
Data %&gt;% ggplot(aes(x = Year, y=Publications, group=Gene, color=Gene)) + geom_line() + scale_colour_manual(values = Line_Colours) </code></pre>
<p><img src="learn_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>It’s still not beautiful… let’s change the theme. Themes are parameters you can add on which change the global graph look - good ggplot themes and you’ll get a list! Try replacing theme_classic() with theme_void() and see what happens! Choose your favourite.</p>
<pre class="r"><code>Data %&gt;% ggplot(aes(x = Year, y=Publications, group=Gene, color=Gene)) + geom_line() + scale_colour_manual(values = Line_Colours) +theme_classic()</code></pre>
<p><img src="learn_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>But I think we should make the lines thicker so they are easier to see. We can do this by going straight to what makes the lines, geom_line, and adding a size parameter. Change ‘1.5’ and see how the lines look. We can also add options like alpha, which changes how <i> transparent</i> lines are, and choose the linetype. Change this to ‘dashed’ and see how it looks!</p>
<pre class="r"><code>Data %&gt;% ggplot(aes(x = Year, y=Publications, group=Gene, color=Gene)) + geom_line(size=1.5, alpha=0.5, linetype=&quot;solid&quot;) + scale_colour_manual(values = Line_Colours) +theme_classic() </code></pre>
<p><img src="learn_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>But our x-axis is horrible! Let’s rotate the labels. To do this, we add a new theme - axis.text.x - and change the horizontal justification to make things look neater</p>
<pre class="r"><code>Data %&gt;% ggplot(aes(x = Year, y=Publications, group=Gene, color=Gene)) + geom_line(size=1.5, alpha=0.5, linetype=&quot;solid&quot;) + scale_colour_manual(values = Line_Colours) +theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1))</code></pre>
<p><img src="learn_files/figure-html/unnamed-chunk-9-1.png" width="672" /> I think the x-axis is still a little crowded, let’s only label every 5 years and rotate the labels to make them easier to read. I’ll also add a base_size to the theme to everything is a little bigger</p>
<pre class="r"><code>Plot_Final &lt;- Data %&gt;% ggplot(aes(x = Year, y=Publications, group=Gene, color=Gene)) + geom_line(size=1.5, alpha=0.5, linetype=&quot;solid&quot;) + scale_colour_manual(values = Line_Colours) +theme_classic(base_size=22) + theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(breaks=seq(1988, 2018, 5))</code></pre>
<p>And you can go on and on to change things to suit your tastes! It’s all a google away. Let’s compare the before and after images.</p>
<pre class="r"><code>grid.arrange(Plot_First, Plot_Final, ncol=2)</code></pre>
<p><img src="learn_files/figure-html/fig6-1.png" width="960" /></p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
